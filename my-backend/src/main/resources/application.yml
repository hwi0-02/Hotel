spring:
  mail:
    host: ${MAIL_HOST:smtp.sendgrid.net}
    port: ${MAIL_PORT:587}
    username: ${MAIL_USERNAME:apikey}
    password: ${MAIL_PASSWORD:}
    protocol: smtp
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connectiontimeout: 5000
          writetimeout: 5000
          timeout: 5000

  security:
    oauth2:
      client:
        registration:
          kakao:
            client-secret: ${KAKAO_CLIENT_SECRET}
            authorization-grant-type: authorization_code
            client-id: ${KAKAO_CLIENT_ID}
            scope: profile_nickname,account_email
            client-authentication-method: client_secret_post
            redirect-uri: https://hwiyeong.shop/login/oauth2/code/kakao
            client-name: Kakao
          naver:
            client-id: ${NAVER_CLIENT_ID}
            redirect-uri: https://hwiyeong.shop/login/oauth2/code/naver
            authorization-grant-type: authorization_code
            scope: name,email
            client-secret: ${NAVER_CLIENT_SECRET}
          google:
            client-id: ${GOOGLE_CLIENT_ID}
            client-secret: ${GOOGLE_CLIENT_SECRET}
            redirect-uri: https://hwiyeong.shop/login/oauth2/code/google
            scope: profile,email
        provider:
          naver:
            authorization-uri: https://nid.naver.com/oauth2.0/authorize
            user-name-attribute: response
            token-uri: https://nid.naver.com/oauth2.0/token
            user-info-uri: https://openapi.naver.com/v1/nid/me
          kakao:
            user-info-uri: https://kapi.kakao.com/v2/user/me
            user-name-attribute: id
            authorization-uri: https://kauth.kakao.com/oauth/authorize
            token-uri: https://kauth.kakao.com/oauth/token

  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MariaDBDialect
    show-sql: 'true'
    open-in-view: 'false'

  application:
    name: my-backend

  datasource:
    driver-class-name: org.mariadb.jdbc.Driver
    url: jdbc:mariadb://${DB_HOST:mariadb}:${DB_PORT:3306}/hotel?useSSL=false&allowPublicKeyRetrieval=true&allowMultiQueries=true
    username: ${DB_USERNAME:night}
    password: ${DB_PASSWORD:night}

  servlet:
    multipart:
      max-request-size: 5MB
      max-file-size: 5MB

  web:
    resources:
      static-locations: file:/opt/my-backend/uploads/

  config:
    import: optional:file:.env[.properties]

  mvc:
    cors:
      mappings:
        # 모든 API 경로에 CORS 적용
        "[/api/**]":
          allowed-origins: ${CORS_ALLOWED_ORIGINS:https://hwiyeong.shop,http://localhost:5173}
          allowed-methods: GET,POST,PUT,PATCH,DELETE,OPTIONS
          allowed-headers: "*"
          exposed-headers: Authorization,Set-Cookie
          allow-credentials: true
          max-age: 3600

mail:
  from: ${MAIL_FROM:spvkf9030@gmail.com}

logging:
  level:
    org.springframework.mail: DEBUG
    org.springframework.mail.javamail: DEBUG
    org.springframework.security: TRACE
    com.sun.mail: DEBUG

file:
  upload:
    dir: uploads
    url: https://hwiyeong.shop/uploads
  upload-dir: ./uploads

jwt:
  secret: ${JWT_SECRET}
  expiration: 86400000   # 24h (ms) - 숫자(long)로

server:
  port: '8888'
  forward-headers-strategy: framework

management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus
  endpoint:
    health:
      show-details: always
  metrics:
    export:
      prometheus:
        enabled: true
